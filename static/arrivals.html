<!-- This file contains a html webpage that can consume an API by performing CRUD operations -->
<!-- Author: Sarah McNelis - G00398343 -->

<html>
	<head>
		<title>Arrivals at Shannon Airport</title>

		<!-- Ajax -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

		<!-- CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

		<!-- JavaScript Bundle with Popper -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

	</head>
	

	<body>
	
		<!-- Pic -->
		<div align="center">
			<img src="snnairport.jpeg" alt="Shannon Airport Logo" width="450" height="250">
		</div>

		<!-- CARD -->
		<div class="card">
			<!-- Card header -->
			<div class="card-header">
				<h3 align="center">Arrivals at Shannon Airport</h3>
			</div>

			<!-- Card body -->
			<div class="card-body">
				<div>
					<table id="example" border="2" class="table table-hover">

						<thead>
						
							<tr>
								<th scope="col">ID</th>
								<th scope="col">Airline</th>
								<th scope="col">Origin</th>
								<th scope="col">Destination</th>
								<th scope="col">Flight Number</th>
							</tr>
							
						</thead>
						
						<tbody id="myTable"></tbody>
						
					</table>
				</div>
			</div>

			<!-- Card footer -->
			<div class="card-footer">
			
				<!-- BUTTON TO DISPLAY CREATE OPTION ALWAYS VISIBLE-->
				<div>
				
					<button id="button-showCreate" onclick="showCreate()">Create an Arrival</button><br/><br/>
					
				</div>
				
				<!-- DIV TO DISPLAY DESIRED FORM WHEN SELECTED -->
				<div id="createUpdateForm" style="display:none">

					<!-- spans are like divs but do not go onto a new line -->
					<h2><span id="createLabel">Create an</span> <span id="updateLabel">Update an</span> Arrival</h2>

					Id <input type="text" name="id"><br/>
					Airline <input type="text" name="airline"><br/>
					Origin <input type="text" name="origin"><br/>
					Destination <input type="text" name="destination"><br/>
					Flight Number <input type="text" name="flightnumber"><br/><br>	

					<span><button id="button-doCreate" onclick="doCreate()">Create Arrival</button></span>
					<span><button id="button-doUpdate" onclick="doUpdate()">Update Arrival</button></span>

				</div>
			</div>
		</div>

		<script>
			
			// Var to store API data in to build my table. 
			var arrivalsArray = []

			// GET ALL ARRIVALS			
			$.ajax({
				"url":"/arrivals",
				"method":"GET",
				"data":"",
				"dataType":"JSON",
				"success":function(result){
					arrivalsArray = result
					// Call function to build my table
					buildTable(arrivalsArray)
					console.log(arrivalsArray)
					
				},
				"error":function(xhr,status,error){
					console.log("status:"+status+" message:"+error);
				}

			});
							
		
			// Code adapted from <https://www.youtube.com/watch?v=ru_YWeOh2kU> to build my table
			function buildTable(data){
				var table = document.getElementById("myTable")
				// Loop to get all elements 
				for (var i = 0; i < data.length; i++){
					var row = 	`
									<tr>\
										<td>${data[i].id}</td>\
										<td>${data[i].airline}</td>\
										<td>${data[i].origin}</td>\
										<td>${data[i].destination}</td>\
										<td>${data[i].flightnumber}</td>\
									</tr>\
								`;
								
					table.innerHTML += row 
				}			
			}
		
		
		
		
		
		
		</script>	
    </body>	
</html>